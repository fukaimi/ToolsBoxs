import{u as Ut,i as Qt}from"./action-282deb75.js";import{T as yt,c as Ht,a as Gt}from"./index-f90c7143.js";import{bu as Xt,A as Nt,k as Yt,aF as st,as as xt,m as At,bj as ht,aE as Wt,x as G,n as kt,o as jt,a$ as A,w as Pt,aT as $t,F as Tt,bi as Zt,aP as Lt,be as Jt,bl as Kt,aG as te}from"./history-7dbe2ade.js";import{a as It}from"./helper-4102c0d3.js";import{a as ee}from"./_commonjsHelpers-87174ba5.js";import"./index-b1ff2442.js";import"./shim-03580cdb.js";const Ct=F=>({is_gradient:!1,simple:F,gradient:{type:"linear",rotation:0,colorStops:[{offset:0,color:F},{offset:1,color:F}]}}),Ft=()=>({tab:"common",is_show:!1,margin:10,error_correction_level:"Q",image_options:{size:4,margin:4},dots_options:{type:"square",color:Ct("#000000")},corners_square_options:{type:"square",color:Ct("#000000")},corners_dot_options:{type:"square",color:Ct("#000000")},background_options:{color:Ct("#ffffff")}}),Dt=F=>{var lt;return F.is_gradient?(F.gradient.rotation=(((lt=F.gradient)==null?void 0:lt.rotation)||0)/180*Math.PI,{gradient:F.gradient,color:void 0}):{color:F.simple,gradient:void 0}},oe=(F,lt,_t)=>{const y=F.is_show?Xt.cloneDeep(F):Ft(),k=Math.ceil(yt.fromString(lt).toUint8Array().length/100)||1;return{data:lt,width:Math.min(2e3,k*300),height:Math.min(2e3,k*300),margin:y.margin,qrOptions:{errorCorrectionLevel:y.error_correction_level,multibyte:"UTF-8"},image:y.image_options.size>0&&_t.isImage()?_t.toDataUrl():"",imageOptions:{hideBackgroundDots:!0,imageSize:y.image_options.size/10,margin:y.image_options.margin},dotsOptions:{type:y.dots_options.type,...Dt(y.dots_options.color)},cornersSquareOptions:{type:y.corners_square_options.type,...Dt(y.corners_square_options.color)},cornersDotOptions:{type:y.corners_dot_options.type,...Dt(y.corners_dot_options.color)},backgroundOptions:{...Dt(y.background_options.color)}}},qt=Nt({__name:"GenerateOptionColor",props:{modelValue:{type:Object,default:()=>Ct("#ffffff")},size:{type:String,default:"default"}},emits:["update:modelValue"],setup(F,{emit:lt}){const _t=F,y=Yt({get:()=>_t.modelValue,set:k=>lt("update:modelValue",k)});return(k,Z)=>{const E=st("Bool"),U=st("Color"),J=st("Radio"),T=st("InputNumber"),q=st("Align");return xt(),At(q,null,{default:ht(()=>[Wt(k.$slots,"default"),G(E,{border:"",size:F.size,modelValue:y.value.is_gradient,"onUpdate:modelValue":Z[0]||(Z[0]=Q=>y.value.is_gradient=Q),label:k.$t("qrCode_generate_option_gradient")},null,8,["size","modelValue","label"]),y.value.is_gradient?kt("",!0):(xt(),At(U,{key:0,size:F.size,modelValue:y.value.simple,"onUpdate:modelValue":Z[1]||(Z[1]=Q=>y.value.simple=Q)},null,8,["size","modelValue"])),y.value.is_gradient?(xt(),jt(Tt,{key:1},[G(U,{size:F.size,modelValue:y.value.gradient.colorStops[0].color,"onUpdate:modelValue":Z[2]||(Z[2]=Q=>y.value.gradient.colorStops[0].color=Q)},null,8,["size","modelValue"]),G(U,{size:F.size,modelValue:y.value.gradient.colorStops[1].color,"onUpdate:modelValue":Z[3]||(Z[3]=Q=>y.value.gradient.colorStops[1].color=Q)},null,8,["size","modelValue"]),G(J,{size:F.size,modelValue:y.value.gradient.type,"onUpdate:modelValue":Z[4]||(Z[4]=Q=>y.value.gradient.type=Q),options:A(It)(["linear","radial"],"qrCode_generate_option_"),button:""},null,8,["size","modelValue","options"]),G(T,{size:F.size,modelValue:y.value.gradient.rotation,"onUpdate:modelValue":Z[5]||(Z[5]=Q=>y.value.gradient.rotation=Q),min:0,max:360,width:100},{prepend:ht(()=>[Pt($t(k.$t("qrCode_generate_option_rotation")),1)]),_:1},8,["size","modelValue"])],64)):kt("",!0)]),_:3})}}});var Vt={},ne={get exports(){return Vt},set exports(F){Vt=F}};(function(F,lt){(function(_t,y){F.exports=y()})(self,()=>(()=>{var _t={192:(E,U)=>{var J,T,q=function(){var Q=function(p,f){var _=p,h=dt[f],u=null,m=0,b=null,v=[],S={},X=function(i,s){u=function(c){for(var l=new Array(c),d=0;d<c;d+=1){l[d]=new Array(c);for(var g=0;g<c;g+=1)l[d][g]=null}return l}(m=4*_+17),Y(0,0),Y(m-7,0),Y(0,m-7),e(),M(),o(i,s),_>=7&&t(i),b==null&&(b=r(_,h,v)),n(b,s)},Y=function(i,s){for(var c=-1;c<=7;c+=1)if(!(i+c<=-1||m<=i+c))for(var l=-1;l<=7;l+=1)s+l<=-1||m<=s+l||(u[i+c][s+l]=0<=c&&c<=6&&(l==0||l==6)||0<=l&&l<=6&&(c==0||c==6)||2<=c&&c<=4&&2<=l&&l<=4)},M=function(){for(var i=8;i<m-8;i+=1)u[i][6]==null&&(u[i][6]=i%2==0);for(var s=8;s<m-8;s+=1)u[6][s]==null&&(u[6][s]=s%2==0)},e=function(){for(var i=ct.getPatternPosition(_),s=0;s<i.length;s+=1)for(var c=0;c<i.length;c+=1){var l=i[s],d=i[c];if(u[l][d]==null)for(var g=-2;g<=2;g+=1)for(var w=-2;w<=2;w+=1)u[l+g][d+w]=g==-2||g==2||w==-2||w==2||g==0&&w==0}},t=function(i){for(var s=ct.getBCHTypeNumber(_),c=0;c<18;c+=1){var l=!i&&(s>>c&1)==1;u[Math.floor(c/3)][c%3+m-8-3]=l}for(c=0;c<18;c+=1)l=!i&&(s>>c&1)==1,u[c%3+m-8-3][Math.floor(c/3)]=l},o=function(i,s){for(var c=h<<3|s,l=ct.getBCHTypeInfo(c),d=0;d<15;d+=1){var g=!i&&(l>>d&1)==1;d<6?u[d][8]=g:d<8?u[d+1][8]=g:u[m-15+d][8]=g}for(d=0;d<15;d+=1)g=!i&&(l>>d&1)==1,d<8?u[8][m-d-1]=g:d<9?u[8][15-d-1+1]=g:u[8][15-d-1]=g;u[m-8][8]=!i},n=function(i,s){for(var c=-1,l=m-1,d=7,g=0,w=ct.getMaskFunction(s),x=m-1;x>0;x-=2)for(x==6&&(x-=1);;){for(var C=0;C<2;C+=1)if(u[l][x-C]==null){var O=!1;g<i.length&&(O=(i[g]>>>d&1)==1),w(l,x-C)&&(O=!O),u[l][x-C]=O,(d-=1)==-1&&(g+=1,d=7)}if((l+=c)<0||m<=l){l-=c,c=-c;break}}},r=function(i,s,c){for(var l=St.getRSBlocks(i,s),d=R(),g=0;g<c.length;g+=1){var w=c[g];d.put(w.getMode(),4),d.put(w.getLength(),ct.getLengthInBits(w.getMode(),i)),w.write(d)}var x=0;for(g=0;g<l.length;g+=1)x+=l[g].dataCount;if(d.getLengthInBits()>8*x)throw"code length overflow. ("+d.getLengthInBits()+">"+8*x+")";for(d.getLengthInBits()+4<=8*x&&d.put(0,4);d.getLengthInBits()%8!=0;)d.putBit(!1);for(;!(d.getLengthInBits()>=8*x||(d.put(236,8),d.getLengthInBits()>=8*x));)d.put(17,8);return function(C,O){for(var z=0,W=0,H=0,L=new Array(O.length),V=new Array(O.length),D=0;D<O.length;D+=1){var at=O[D].dataCount,nt=O[D].totalCount-at;W=Math.max(W,at),H=Math.max(H,nt),L[D]=new Array(at);for(var $=0;$<L[D].length;$+=1)L[D][$]=255&C.getBuffer()[$+z];z+=at;var N=ct.getErrorCorrectPolynomial(nt),I=mt(L[D],N.getLength()-1).mod(N);for(V[D]=new Array(N.getLength()-1),$=0;$<V[D].length;$+=1){var B=$+I.getLength()-V[D].length;V[D][$]=B>=0?I.getAt(B):0}}var K=0;for($=0;$<O.length;$+=1)K+=O[$].totalCount;var et=new Array(K),P=0;for($=0;$<W;$+=1)for(D=0;D<O.length;D+=1)$<L[D].length&&(et[P]=L[D][$],P+=1);for($=0;$<H;$+=1)for(D=0;D<O.length;D+=1)$<V[D].length&&(et[P]=V[D][$],P+=1);return et}(d,l)};S.addData=function(i,s){var c=null;switch(s=s||"Byte"){case"Numeric":c=ot(i);break;case"Alphanumeric":c=wt(i);break;case"Byte":c=Ot(i);break;case"Kanji":c=Mt(i);break;default:throw"mode:"+s}v.push(c),b=null},S.isDark=function(i,s){if(i<0||m<=i||s<0||m<=s)throw i+","+s;return u[i][s]},S.getModuleCount=function(){return m},S.make=function(){if(_<1){for(var i=1;i<40;i++){for(var s=St.getRSBlocks(i,h),c=R(),l=0;l<v.length;l++){var d=v[l];c.put(d.getMode(),4),c.put(d.getLength(),ct.getLengthInBits(d.getMode(),i)),d.write(c)}var g=0;for(l=0;l<s.length;l++)g+=s[l].dataCount;if(c.getLengthInBits()<=8*g)break}_=i}X(!1,function(){for(var w=0,x=0,C=0;C<8;C+=1){X(!0,C);var O=ct.getLostPoint(S);(C==0||w>O)&&(w=O,x=C)}return x}())},S.createTableTag=function(i,s){i=i||2;var c="";c+='<table style="',c+=" border-width: 0px; border-style: none;",c+=" border-collapse: collapse;",c+=" padding: 0px; margin: "+(s=s===void 0?4*i:s)+"px;",c+='">',c+="<tbody>";for(var l=0;l<S.getModuleCount();l+=1){c+="<tr>";for(var d=0;d<S.getModuleCount();d+=1)c+='<td style="',c+=" border-width: 0px; border-style: none;",c+=" border-collapse: collapse;",c+=" padding: 0px; margin: 0px;",c+=" width: "+i+"px;",c+=" height: "+i+"px;",c+=" background-color: ",c+=S.isDark(l,d)?"#000000":"#ffffff",c+=";",c+='"/>';c+="</tr>"}return(c+="</tbody>")+"</table>"},S.createSvgTag=function(i,s,c,l){var d={};typeof arguments[0]=="object"&&(i=(d=arguments[0]).cellSize,s=d.margin,c=d.alt,l=d.title),i=i||2,s=s===void 0?4*i:s,(c=typeof c=="string"?{text:c}:c||{}).text=c.text||null,c.id=c.text?c.id||"qrcode-description":null,(l=typeof l=="string"?{text:l}:l||{}).text=l.text||null,l.id=l.text?l.id||"qrcode-title":null;var g,w,x,C,O=S.getModuleCount()*i+2*s,z="";for(C="l"+i+",0 0,"+i+" -"+i+",0 0,-"+i+"z ",z+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',z+=d.scalable?"":' width="'+O+'px" height="'+O+'px"',z+=' viewBox="0 0 '+O+" "+O+'" ',z+=' preserveAspectRatio="xMinYMin meet"',z+=l.text||c.text?' role="img" aria-labelledby="'+a([l.id,c.id].join(" ").trim())+'"':"",z+=">",z+=l.text?'<title id="'+a(l.id)+'">'+a(l.text)+"</title>":"",z+=c.text?'<description id="'+a(c.id)+'">'+a(c.text)+"</description>":"",z+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',z+='<path d="',w=0;w<S.getModuleCount();w+=1)for(x=w*i+s,g=0;g<S.getModuleCount();g+=1)S.isDark(w,g)&&(z+="M"+(g*i+s)+","+x+C);return(z+='" stroke="transparent" fill="black"/>')+"</svg>"},S.createDataURL=function(i,s){i=i||2,s=s===void 0?4*i:s;var c=S.getModuleCount()*i+2*s,l=s,d=c-s;return vt(c,c,function(g,w){if(l<=g&&g<d&&l<=w&&w<d){var x=Math.floor((g-l)/i),C=Math.floor((w-l)/i);return S.isDark(C,x)?0:1}return 1})},S.createImgTag=function(i,s,c){i=i||2,s=s===void 0?4*i:s;var l=S.getModuleCount()*i+2*s,d="";return d+="<img",d+=' src="',d+=S.createDataURL(i,s),d+='"',d+=' width="',d+=l,d+='"',d+=' height="',d+=l,d+='"',c&&(d+=' alt="',d+=a(c),d+='"'),d+"/>"};var a=function(i){for(var s="",c=0;c<i.length;c+=1){var l=i.charAt(c);switch(l){case"<":s+="&lt;";break;case">":s+="&gt;";break;case"&":s+="&amp;";break;case'"':s+="&quot;";break;default:s+=l}}return s};return S.createASCII=function(i,s){if((i=i||1)<2)return function(L){L=L===void 0?2:L;var V,D,at,nt,$,N=1*S.getModuleCount()+2*L,I=L,B=N-L,K={"██":"█","█ ":"▀"," █":"▄","  ":" "},et={"██":"▀","█ ":"▀"," █":" ","  ":" "},P="";for(V=0;V<N;V+=2){for(at=Math.floor((V-I)/1),nt=Math.floor((V+1-I)/1),D=0;D<N;D+=1)$="█",I<=D&&D<B&&I<=V&&V<B&&S.isDark(at,Math.floor((D-I)/1))&&($=" "),I<=D&&D<B&&I<=V+1&&V+1<B&&S.isDark(nt,Math.floor((D-I)/1))?$+=" ":$+="█",P+=L<1&&V+1>=B?et[$]:K[$];P+=`
`}return N%2&&L>0?P.substring(0,P.length-N-1)+Array(N+1).join("▀"):P.substring(0,P.length-1)}(s);i-=1,s=s===void 0?2*i:s;var c,l,d,g,w=S.getModuleCount()*i+2*s,x=s,C=w-s,O=Array(i+1).join("██"),z=Array(i+1).join("  "),W="",H="";for(c=0;c<w;c+=1){for(d=Math.floor((c-x)/i),H="",l=0;l<w;l+=1)g=1,x<=l&&l<C&&x<=c&&c<C&&S.isDark(d,Math.floor((l-x)/i))&&(g=0),H+=g?O:z;for(d=0;d<i;d+=1)W+=H+`
`}return W.substring(0,W.length-1)},S.renderTo2dContext=function(i,s){s=s||2;for(var c=S.getModuleCount(),l=0;l<c;l++)for(var d=0;d<c;d++)i.fillStyle=S.isDark(l,d)?"black":"white",i.fillRect(l*s,d*s,s,s)},S};Q.stringToBytes=(Q.stringToBytesFuncs={default:function(p){for(var f=[],_=0;_<p.length;_+=1){var h=p.charCodeAt(_);f.push(255&h)}return f}}).default,Q.createStringToBytes=function(p,f){var _=function(){for(var u=Rt(p),m=function(){var M=u.read();if(M==-1)throw"eof";return M},b=0,v={};;){var S=u.read();if(S==-1)break;var X=m(),Y=m()<<8|m();v[String.fromCharCode(S<<8|X)]=Y,b+=1}if(b!=f)throw b+" != "+f;return v}(),h="?".charCodeAt(0);return function(u){for(var m=[],b=0;b<u.length;b+=1){var v=u.charCodeAt(b);if(v<128)m.push(v);else{var S=_[u.charAt(b)];typeof S=="number"?(255&S)==S?m.push(S):(m.push(S>>>8),m.push(255&S)):m.push(h)}}return m}};var pt,rt,it,j,tt,dt={L:1,M:0,Q:3,H:2},ct=(pt=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],rt=1335,it=7973,tt=function(p){for(var f=0;p!=0;)f+=1,p>>>=1;return f},(j={}).getBCHTypeInfo=function(p){for(var f=p<<10;tt(f)-tt(rt)>=0;)f^=rt<<tt(f)-tt(rt);return 21522^(p<<10|f)},j.getBCHTypeNumber=function(p){for(var f=p<<12;tt(f)-tt(it)>=0;)f^=it<<tt(f)-tt(it);return p<<12|f},j.getPatternPosition=function(p){return pt[p-1]},j.getMaskFunction=function(p){switch(p){case 0:return function(f,_){return(f+_)%2==0};case 1:return function(f,_){return f%2==0};case 2:return function(f,_){return _%3==0};case 3:return function(f,_){return(f+_)%3==0};case 4:return function(f,_){return(Math.floor(f/2)+Math.floor(_/3))%2==0};case 5:return function(f,_){return f*_%2+f*_%3==0};case 6:return function(f,_){return(f*_%2+f*_%3)%2==0};case 7:return function(f,_){return(f*_%3+(f+_)%2)%2==0};default:throw"bad maskPattern:"+p}},j.getErrorCorrectPolynomial=function(p){for(var f=mt([1],0),_=0;_<p;_+=1)f=f.multiply(mt([1,gt.gexp(_)],0));return f},j.getLengthInBits=function(p,f){if(1<=f&&f<10)switch(p){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+p}else if(f<27)switch(p){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+p}else{if(!(f<41))throw"type:"+f;switch(p){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+p}}},j.getLostPoint=function(p){for(var f=p.getModuleCount(),_=0,h=0;h<f;h+=1)for(var u=0;u<f;u+=1){for(var m=0,b=p.isDark(h,u),v=-1;v<=1;v+=1)if(!(h+v<0||f<=h+v))for(var S=-1;S<=1;S+=1)u+S<0||f<=u+S||v==0&&S==0||b==p.isDark(h+v,u+S)&&(m+=1);m>5&&(_+=3+m-5)}for(h=0;h<f-1;h+=1)for(u=0;u<f-1;u+=1){var X=0;p.isDark(h,u)&&(X+=1),p.isDark(h+1,u)&&(X+=1),p.isDark(h,u+1)&&(X+=1),p.isDark(h+1,u+1)&&(X+=1),X!=0&&X!=4||(_+=3)}for(h=0;h<f;h+=1)for(u=0;u<f-6;u+=1)p.isDark(h,u)&&!p.isDark(h,u+1)&&p.isDark(h,u+2)&&p.isDark(h,u+3)&&p.isDark(h,u+4)&&!p.isDark(h,u+5)&&p.isDark(h,u+6)&&(_+=40);for(u=0;u<f;u+=1)for(h=0;h<f-6;h+=1)p.isDark(h,u)&&!p.isDark(h+1,u)&&p.isDark(h+2,u)&&p.isDark(h+3,u)&&p.isDark(h+4,u)&&!p.isDark(h+5,u)&&p.isDark(h+6,u)&&(_+=40);var Y=0;for(u=0;u<f;u+=1)for(h=0;h<f;h+=1)p.isDark(h,u)&&(Y+=1);return _+Math.abs(100*Y/f/f-50)/5*10},j),gt=function(){for(var p=new Array(256),f=new Array(256),_=0;_<8;_+=1)p[_]=1<<_;for(_=8;_<256;_+=1)p[_]=p[_-4]^p[_-5]^p[_-6]^p[_-8];for(_=0;_<255;_+=1)f[p[_]]=_;return{glog:function(h){if(h<1)throw"glog("+h+")";return f[h]},gexp:function(h){for(;h<0;)h+=255;for(;h>=256;)h-=255;return p[h]}}}();function mt(p,f){if(p.length===void 0)throw p.length+"/"+f;var _=function(){for(var u=0;u<p.length&&p[u]==0;)u+=1;for(var m=new Array(p.length-u+f),b=0;b<p.length-u;b+=1)m[b]=p[b+u];return m}(),h={getAt:function(u){return _[u]},getLength:function(){return _.length},multiply:function(u){for(var m=new Array(h.getLength()+u.getLength()-1),b=0;b<h.getLength();b+=1)for(var v=0;v<u.getLength();v+=1)m[b+v]^=gt.gexp(gt.glog(h.getAt(b))+gt.glog(u.getAt(v)));return mt(m,0)},mod:function(u){if(h.getLength()-u.getLength()<0)return h;for(var m=gt.glog(h.getAt(0))-gt.glog(u.getAt(0)),b=new Array(h.getLength()),v=0;v<h.getLength();v+=1)b[v]=h.getAt(v);for(v=0;v<u.getLength();v+=1)b[v]^=gt.gexp(gt.glog(u.getAt(v))+m);return mt(b,0).mod(u)}};return h}var St=function(){var p=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],f=function(h,u){var m={};return m.totalCount=h,m.dataCount=u,m},_={getRSBlocks:function(h,u){var m=function(t,o){switch(o){case dt.L:return p[4*(t-1)+0];case dt.M:return p[4*(t-1)+1];case dt.Q:return p[4*(t-1)+2];case dt.H:return p[4*(t-1)+3];default:return}}(h,u);if(m===void 0)throw"bad rs block @ typeNumber:"+h+"/errorCorrectionLevel:"+u;for(var b=m.length/3,v=[],S=0;S<b;S+=1)for(var X=m[3*S+0],Y=m[3*S+1],M=m[3*S+2],e=0;e<X;e+=1)v.push(f(Y,M));return v}};return _}(),R=function(){var p=[],f=0,_={getBuffer:function(){return p},getAt:function(h){var u=Math.floor(h/8);return(p[u]>>>7-h%8&1)==1},put:function(h,u){for(var m=0;m<u;m+=1)_.putBit((h>>>u-m-1&1)==1)},getLengthInBits:function(){return f},putBit:function(h){var u=Math.floor(f/8);p.length<=u&&p.push(0),h&&(p[u]|=128>>>f%8),f+=1}};return _},ot=function(p){var f=p,_={getMode:function(){return 1},getLength:function(m){return f.length},write:function(m){for(var b=f,v=0;v+2<b.length;)m.put(h(b.substring(v,v+3)),10),v+=3;v<b.length&&(b.length-v==1?m.put(h(b.substring(v,v+1)),4):b.length-v==2&&m.put(h(b.substring(v,v+2)),7))}},h=function(m){for(var b=0,v=0;v<m.length;v+=1)b=10*b+u(m.charAt(v));return b},u=function(m){if("0"<=m&&m<="9")return m.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+m};return _},wt=function(p){var f=p,_={getMode:function(){return 2},getLength:function(u){return f.length},write:function(u){for(var m=f,b=0;b+1<m.length;)u.put(45*h(m.charAt(b))+h(m.charAt(b+1)),11),b+=2;b<m.length&&u.put(h(m.charAt(b)),6)}},h=function(u){if("0"<=u&&u<="9")return u.charCodeAt(0)-"0".charCodeAt(0);if("A"<=u&&u<="Z")return u.charCodeAt(0)-"A".charCodeAt(0)+10;switch(u){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+u}};return _},Ot=function(p){var f=Q.stringToBytes(p);return{getMode:function(){return 4},getLength:function(_){return f.length},write:function(_){for(var h=0;h<f.length;h+=1)_.put(f[h],8)}}},Mt=function(p){var f=Q.stringToBytesFuncs.SJIS;if(!f)throw"sjis not supported.";(function(u,m){var b=f("友");if(b.length!=2||(b[0]<<8|b[1])!=38726)throw"sjis not supported."})();var _=f(p),h={getMode:function(){return 8},getLength:function(u){return~~(_.length/2)},write:function(u){for(var m=_,b=0;b+1<m.length;){var v=(255&m[b])<<8|255&m[b+1];if(33088<=v&&v<=40956)v-=33088;else{if(!(57408<=v&&v<=60351))throw"illegal char at "+(b+1)+"/"+v;v-=49472}v=192*(v>>>8&255)+(255&v),u.put(v,13),b+=2}if(b<m.length)throw"illegal char at "+(b+1)}};return h},zt=function(){var p=[],f={writeByte:function(_){p.push(255&_)},writeShort:function(_){f.writeByte(_),f.writeByte(_>>>8)},writeBytes:function(_,h,u){h=h||0,u=u||_.length;for(var m=0;m<u;m+=1)f.writeByte(_[m+h])},writeString:function(_){for(var h=0;h<_.length;h+=1)f.writeByte(_.charCodeAt(h))},toByteArray:function(){return p},toString:function(){var _="";_+="[";for(var h=0;h<p.length;h+=1)h>0&&(_+=","),_+=p[h];return _+"]"}};return f},Rt=function(p){var f=p,_=0,h=0,u=0,m={read:function(){for(;u<8;){if(_>=f.length){if(u==0)return-1;throw"unexpected end of file./"+u}var v=f.charAt(_);if(_+=1,v=="=")return u=0,-1;v.match(/^\s$/)||(h=h<<6|b(v.charCodeAt(0)),u+=6)}var S=h>>>u-8&255;return u-=8,S}},b=function(v){if(65<=v&&v<=90)return v-65;if(97<=v&&v<=122)return v-97+26;if(48<=v&&v<=57)return v-48+52;if(v==43)return 62;if(v==47)return 63;throw"c:"+v};return m},vt=function(p,f,_){for(var h=function(Y,M){var e=Y,t=M,o=new Array(Y*M),n={setPixel:function(i,s,c){o[s*e+i]=c},write:function(i){i.writeString("GIF87a"),i.writeShort(e),i.writeShort(t),i.writeByte(128),i.writeByte(0),i.writeByte(0),i.writeByte(0),i.writeByte(0),i.writeByte(0),i.writeByte(255),i.writeByte(255),i.writeByte(255),i.writeString(","),i.writeShort(0),i.writeShort(0),i.writeShort(e),i.writeShort(t),i.writeByte(0);var s=r(2);i.writeByte(2);for(var c=0;s.length-c>255;)i.writeByte(255),i.writeBytes(s,c,255),c+=255;i.writeByte(s.length-c),i.writeBytes(s,c,s.length-c),i.writeByte(0),i.writeString(";")}},r=function(i){for(var s=1<<i,c=1+(1<<i),l=i+1,d=a(),g=0;g<s;g+=1)d.add(String.fromCharCode(g));d.add(String.fromCharCode(s)),d.add(String.fromCharCode(c));var w,x,C,O=zt(),z=(w=O,x=0,C=0,{write:function(V,D){if(V>>>D)throw"length over";for(;x+D>=8;)w.writeByte(255&(V<<x|C)),D-=8-x,V>>>=8-x,C=0,x=0;C|=V<<x,x+=D},flush:function(){x>0&&w.writeByte(C)}});z.write(s,l);var W=0,H=String.fromCharCode(o[W]);for(W+=1;W<o.length;){var L=String.fromCharCode(o[W]);W+=1,d.contains(H+L)?H+=L:(z.write(d.indexOf(H),l),d.size()<4095&&(d.size()==1<<l&&(l+=1),d.add(H+L)),H=L)}return z.write(d.indexOf(H),l),z.write(c,l),z.flush(),O.toByteArray()},a=function(){var i={},s=0,c={add:function(l){if(c.contains(l))throw"dup key:"+l;i[l]=s,s+=1},size:function(){return s},indexOf:function(l){return i[l]},contains:function(l){return i[l]!==void 0}};return c};return n}(p,f),u=0;u<f;u+=1)for(var m=0;m<p;m+=1)h.setPixel(m,u,_(m,u));var b=zt();h.write(b);for(var v=function(){var Y=0,M=0,e=0,t="",o={},n=function(a){t+=String.fromCharCode(r(63&a))},r=function(a){if(!(a<0)){if(a<26)return 65+a;if(a<52)return a-26+97;if(a<62)return a-52+48;if(a==62)return 43;if(a==63)return 47}throw"n:"+a};return o.writeByte=function(a){for(Y=Y<<8|255&a,M+=8,e+=1;M>=6;)n(Y>>>M-6),M-=6},o.flush=function(){if(M>0&&(n(Y<<6-M),Y=0,M=0),e%3!=0)for(var a=3-e%3,i=0;i<a;i+=1)t+="="},o.toString=function(){return t},o}(),S=b.toByteArray(),X=0;X<S.length;X+=1)v.writeByte(S[X]);return v.flush(),"data:image/gif;base64,"+v};return Q}();q.stringToBytesFuncs["UTF-8"]=function(Q){return function(pt){for(var rt=[],it=0;it<pt.length;it++){var j=pt.charCodeAt(it);j<128?rt.push(j):j<2048?rt.push(192|j>>6,128|63&j):j<55296||j>=57344?rt.push(224|j>>12,128|j>>6&63,128|63&j):(it++,j=65536+((1023&j)<<10|1023&pt.charCodeAt(it)),rt.push(240|j>>18,128|j>>12&63,128|j>>6&63,128|63&j))}return rt}(Q)},(T=typeof(J=function(){return q})=="function"?J.apply(U,[]):J)===void 0||(E.exports=T)}},y={};function k(E){var U=y[E];if(U!==void 0)return U.exports;var J=y[E]={exports:{}};return _t[E](J,J.exports,k),J.exports}k.n=E=>{var U=E&&E.__esModule?()=>E.default:()=>E;return k.d(U,{a:U}),U},k.d=(E,U)=>{for(var J in U)k.o(U,J)&&!k.o(E,J)&&Object.defineProperty(E,J,{enumerable:!0,get:U[J]})},k.o=(E,U)=>Object.prototype.hasOwnProperty.call(E,U);var Z={};return(()=>{k.d(Z,{default:()=>Y});const E=M=>!!M&&typeof M=="object"&&!Array.isArray(M);function U(M,...e){if(!e.length)return M;const t=e.shift();return t!==void 0&&E(M)&&E(t)?(M=Object.assign({},M),Object.keys(t).forEach(o=>{const n=M[o],r=t[o];Array.isArray(n)&&Array.isArray(r)?M[o]=r:E(n)&&E(r)?M[o]=U(Object.assign({},n),r):M[o]=r}),U(M,...e)):M}function J(M,e){const t=document.createElement("a");t.download=e,t.href=M,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function T({originalHeight:M,originalWidth:e,maxHiddenDots:t,maxHiddenAxisDots:o,dotSize:n}){const r={x:0,y:0},a={x:0,y:0};if(M<=0||e<=0||t<=0||n<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const i=M/e;return r.x=Math.floor(Math.sqrt(t/i)),r.x<=0&&(r.x=1),o&&o<r.x&&(r.x=o),r.x%2==0&&r.x--,a.x=r.x*n,r.y=1+2*Math.ceil((r.x*i-1)/2),a.y=Math.round(a.x*i),(r.y*r.x>t||o&&o<r.y)&&(o&&o<r.y?(r.y=o,r.y%2==0&&r.x--):r.y-=2,a.y=r.y*n,r.x=1+2*Math.ceil((r.y/i-1)/2),a.x=Math.round(a.y/i)),{height:a.y,width:a.x,hideYDots:r.x,hideXDots:r.y}}const q={L:.07,M:.15,Q:.25,H:.3},Q="dots",pt="rounded",rt="classy",it="classy-rounded",j="extra-rounded";class tt{constructor({context:e,type:t}){this._context=e,this._type=t}draw(e,t,o,n){const r=this._context;let a;switch(this._type){case Q:a=this._drawDot;break;case rt:a=this._drawClassy;break;case it:a=this._drawClassyRounded;break;case pt:a=this._drawRounded;break;case j:a=this._drawExtraRounded;break;default:a=this._drawSquare}a.call(this,{x:e,y:t,size:o,context:r,getNeighbor:n})}_rotateFigure({x:e,y:t,size:o,context:n,rotation:r=0,draw:a}){const i=e+o/2,s=t+o/2;n.translate(i,s),r&&n.rotate(r),a(),n.closePath(),r&&n.rotate(-r),n.translate(-i,-s)}_basicDot(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,0,2*Math.PI)}}))}_basicSquare(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.rect(-t/2,-t/2,t,t)}}))}_basicSideRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,-Math.PI/2,Math.PI/2),o.lineTo(-t/2,t/2),o.lineTo(-t/2,-t/2),o.lineTo(0,-t/2)}}))}_basicCornerRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,-Math.PI/2,0),o.lineTo(t/2,t/2),o.lineTo(-t/2,t/2),o.lineTo(-t/2,-t/2),o.lineTo(0,-t/2)}}))}_basicCornerExtraRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(-t/2,t/2,t,-Math.PI/2,0),o.lineTo(-t/2,t/2),o.lineTo(-t/2,-t/2)}}))}_basicCornersRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,-Math.PI/2,0),o.lineTo(t/2,t/2),o.lineTo(0,t/2),o.arc(0,0,t/2,Math.PI/2,Math.PI),o.lineTo(-t/2,-t/2),o.lineTo(0,-t/2)}}))}_basicCornersExtraRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(-t/2,t/2,t,-Math.PI/2,0),o.arc(t/2,-t/2,t,Math.PI/2,Math.PI)}}))}_drawDot({x:e,y:t,size:o,context:n}){this._basicDot({x:e,y:t,size:o,context:n,rotation:0})}_drawSquare({x:e,y:t,size:o,context:n}){this._basicSquare({x:e,y:t,size:o,context:n,rotation:0})}_drawRounded({x:e,y:t,size:o,context:n,getNeighbor:r}){const a=r?+r(-1,0):0,i=r?+r(1,0):0,s=r?+r(0,-1):0,c=r?+r(0,1):0,l=a+i+s+c;if(l!==0)if(l>2||a&&i||s&&c)this._basicSquare({x:e,y:t,size:o,context:n,rotation:0});else{if(l===2){let d=0;return a&&s?d=Math.PI/2:s&&i?d=Math.PI:i&&c&&(d=-Math.PI/2),void this._basicCornerRounded({x:e,y:t,size:o,context:n,rotation:d})}if(l===1){let d=0;return s?d=Math.PI/2:i?d=Math.PI:c&&(d=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,context:n,rotation:d})}}else this._basicDot({x:e,y:t,size:o,context:n,rotation:0})}_drawExtraRounded({x:e,y:t,size:o,context:n,getNeighbor:r}){const a=r?+r(-1,0):0,i=r?+r(1,0):0,s=r?+r(0,-1):0,c=r?+r(0,1):0,l=a+i+s+c;if(l!==0)if(l>2||a&&i||s&&c)this._basicSquare({x:e,y:t,size:o,context:n,rotation:0});else{if(l===2){let d=0;return a&&s?d=Math.PI/2:s&&i?d=Math.PI:i&&c&&(d=-Math.PI/2),void this._basicCornerExtraRounded({x:e,y:t,size:o,context:n,rotation:d})}if(l===1){let d=0;return s?d=Math.PI/2:i?d=Math.PI:c&&(d=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,context:n,rotation:d})}}else this._basicDot({x:e,y:t,size:o,context:n,rotation:0})}_drawClassy({x:e,y:t,size:o,context:n,getNeighbor:r}){const a=r?+r(-1,0):0,i=r?+r(1,0):0,s=r?+r(0,-1):0,c=r?+r(0,1):0;a+i+s+c!==0?a||s?i||c?this._basicSquare({x:e,y:t,size:o,context:n,rotation:0}):this._basicCornerRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2}):this._basicCornerRounded({x:e,y:t,size:o,context:n,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2})}_drawClassyRounded({x:e,y:t,size:o,context:n,getNeighbor:r}){const a=r?+r(-1,0):0,i=r?+r(1,0):0,s=r?+r(0,-1):0,c=r?+r(0,1):0;a+i+s+c!==0?a||s?i||c?this._basicSquare({x:e,y:t,size:o,context:n,rotation:0}):this._basicCornerExtraRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:e,y:t,size:o,context:n,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2})}}const dt="square",ct="extra-rounded";class gt{constructor({context:e,type:t}){this._context=e,this._type=t}draw(e,t,o,n){const r=this._context;let a;switch(this._type){case dt:a=this._drawSquare;break;case ct:a=this._drawExtraRounded;break;default:a=this._drawDot}a.call(this,{x:e,y:t,size:o,context:r,rotation:n})}_rotateFigure({x:e,y:t,size:o,context:n,rotation:r=0,draw:a}){const i=e+o/2,s=t+o/2;n.translate(i,s),r&&n.rotate(r),a(),n.closePath(),r&&n.rotate(-r),n.translate(-i,-s)}_basicDot(e){const{size:t,context:o}=e,n=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,0,2*Math.PI),o.arc(0,0,t/2-n,0,2*Math.PI)}}))}_basicSquare(e){const{size:t,context:o}=e,n=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.rect(-t/2,-t/2,t,t),o.rect(-t/2+n,-t/2+n,t-2*n,t-2*n)}}))}_basicExtraRounded(e){const{size:t,context:o}=e,n=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(-n,-n,2.5*n,Math.PI,-Math.PI/2),o.lineTo(n,-3.5*n),o.arc(n,-n,2.5*n,-Math.PI/2,0),o.lineTo(3.5*n,-n),o.arc(n,n,2.5*n,0,Math.PI/2),o.lineTo(-n,3.5*n),o.arc(-n,n,2.5*n,Math.PI/2,Math.PI),o.lineTo(-3.5*n,-n),o.arc(-n,-n,1.5*n,Math.PI,-Math.PI/2),o.lineTo(n,-2.5*n),o.arc(n,-n,1.5*n,-Math.PI/2,0),o.lineTo(2.5*n,-n),o.arc(n,n,1.5*n,0,Math.PI/2),o.lineTo(-n,2.5*n),o.arc(-n,n,1.5*n,Math.PI/2,Math.PI),o.lineTo(-2.5*n,-n)}}))}_drawDot({x:e,y:t,size:o,context:n,rotation:r}){this._basicDot({x:e,y:t,size:o,context:n,rotation:r})}_drawSquare({x:e,y:t,size:o,context:n,rotation:r}){this._basicSquare({x:e,y:t,size:o,context:n,rotation:r})}_drawExtraRounded({x:e,y:t,size:o,context:n,rotation:r}){this._basicExtraRounded({x:e,y:t,size:o,context:n,rotation:r})}}const mt="square";class St{constructor({context:e,type:t}){this._context=e,this._type=t}draw(e,t,o,n){const r=this._context;let a;a=this._type===mt?this._drawSquare:this._drawDot,a.call(this,{x:e,y:t,size:o,context:r,rotation:n})}_rotateFigure({x:e,y:t,size:o,context:n,rotation:r=0,draw:a}){const i=e+o/2,s=t+o/2;n.translate(i,s),r&&n.rotate(r),a(),n.closePath(),r&&n.rotate(-r),n.translate(-i,-s)}_basicDot(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,0,2*Math.PI)}}))}_basicSquare(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.rect(-t/2,-t/2,t,t)}}))}_drawDot({x:e,y:t,size:o,context:n,rotation:r}){this._basicDot({x:e,y:t,size:o,context:n,rotation:r})}_drawSquare({x:e,y:t,size:o,context:n,rotation:r}){this._basicSquare({x:e,y:t,size:o,context:n,rotation:r})}}const R="radial",ot=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],wt=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class Ot{constructor(e){this._canvas=document.createElement("canvas"),this._canvas.width=e.width,this._canvas.height=e.height,this._options=e}get context(){return this._canvas.getContext("2d")}get width(){return this._canvas.width}get height(){return this._canvas.height}getCanvas(){return this._canvas}clear(){const e=this.context;e&&e.clearRect(0,0,this._canvas.width,this._canvas.height)}async drawQR(e){const t=e.getModuleCount(),o=Math.min(this._options.width,this._options.height)-2*this._options.margin,n=Math.floor(o/t);let r={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=e,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:a,qrOptions:i}=this._options,s=a.imageSize*q[i.errorCorrectionLevel],c=Math.floor(s*t*t);r=T({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:c,maxHiddenAxisDots:t-14,dotSize:n})}this.clear(),this.drawBackground(),this.drawDots((a,i)=>{var s,c,l,d,g,w;return!(this._options.imageOptions.hideBackgroundDots&&a>=(t-r.hideXDots)/2&&a<(t+r.hideXDots)/2&&i>=(t-r.hideYDots)/2&&i<(t+r.hideYDots)/2||!((s=ot[a])===null||s===void 0)&&s[i]||!((c=ot[a-t+7])===null||c===void 0)&&c[i]||!((l=ot[a])===null||l===void 0)&&l[i-t+7]||!((d=wt[a])===null||d===void 0)&&d[i]||!((g=wt[a-t+7])===null||g===void 0)&&g[i]||!((w=wt[a])===null||w===void 0)&&w[i-t+7])}),this.drawCorners(),this._options.image&&this.drawImage({width:r.width,height:r.height,count:t,dotSize:n})}drawBackground(){const e=this.context,t=this._options;if(e){if(t.backgroundOptions.gradient){const o=t.backgroundOptions.gradient,n=this._createGradient({context:e,options:o,additionalRotation:0,x:0,y:0,size:this._canvas.width>this._canvas.height?this._canvas.width:this._canvas.height});o.colorStops.forEach(({offset:r,color:a})=>{n.addColorStop(r,a)}),e.fillStyle=n}else t.backgroundOptions.color&&(e.fillStyle=t.backgroundOptions.color);e.fillRect(0,0,this._canvas.width,this._canvas.height)}}drawDots(e){if(!this._qr)throw"QR code is not defined";const t=this.context;if(!t)throw"QR code is not defined";const o=this._options,n=this._qr.getModuleCount();if(n>o.width||n>o.height)throw"The canvas is too small.";const r=Math.min(o.width,o.height)-2*o.margin,a=Math.floor(r/n),i=Math.floor((o.width-n*a)/2),s=Math.floor((o.height-n*a)/2),c=new tt({context:t,type:o.dotsOptions.type});t.beginPath();for(let l=0;l<n;l++)for(let d=0;d<n;d++){if(e&&!e(l,d)||!this._qr.isDark(l,d))continue;const g=this._options.useLegacyDotRotation?i+l*a:s+d*a,w=this._options.useLegacyDotRotation?s+d*a:i+l*a;c.draw(g,w,a,(x,C)=>this._options.useLegacyDotRotation?!(l+x<0||d+C<0||l+x>=n||d+C>=n)&&!(e&&!e(l+x,d+C))&&!!this._qr&&this._qr.isDark(l+x,d+C):!(d+x<0||l+C<0||d+x>=n||l+C>=n)&&!(e&&!e(d+x,l+C))&&!!this._qr&&this._qr.isDark(l+C,d+x))}if(o.dotsOptions.gradient){const l=o.dotsOptions.gradient,d=this._createGradient({context:t,options:l,additionalRotation:0,x:i,y:s,size:n*a});l.colorStops.forEach(({offset:g,color:w})=>{d.addColorStop(g,w)}),t.fillStyle=t.strokeStyle=d}else o.dotsOptions.color&&(t.fillStyle=t.strokeStyle=o.dotsOptions.color);t.fill("evenodd")}drawCorners(e){if(!this._qr)throw"QR code is not defined";const t=this.context;if(!t)throw"QR code is not defined";const o=this._options,n=this._qr.getModuleCount(),r=Math.min(o.width,o.height)-2*o.margin,a=Math.floor(r/n),i=7*a,s=3*a,c=Math.floor((o.width-n*a)/2),l=Math.floor((o.height-n*a)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([d,g,w])=>{var x,C,O,z,W,H,L,V,D,at;if(e&&!e(d,g))return;const nt=c+d*a*(n-7),$=l+g*a*(n-7);if(!((x=o.cornersSquareOptions)===null||x===void 0)&&x.type){const N=new gt({context:t,type:(C=o.cornersSquareOptions)===null||C===void 0?void 0:C.type});t.beginPath(),N.draw(nt,$,i,w)}else{const N=new tt({context:t,type:o.dotsOptions.type});t.beginPath();for(let I=0;I<ot.length;I++)for(let B=0;B<ot[I].length;B++)!((O=ot[I])===null||O===void 0)&&O[B]&&N.draw(nt+I*a,$+B*a,a,(K,et)=>{var P;return!!(!((P=ot[I+K])===null||P===void 0)&&P[B+et])})}if(!((z=o.cornersSquareOptions)===null||z===void 0)&&z.gradient){const N=o.cornersSquareOptions.gradient,I=this._createGradient({context:t,options:N,additionalRotation:w,x:nt,y:$,size:i});N.colorStops.forEach(({offset:B,color:K})=>{I.addColorStop(B,K)}),t.fillStyle=t.strokeStyle=I}else!((W=o.cornersSquareOptions)===null||W===void 0)&&W.color&&(t.fillStyle=t.strokeStyle=o.cornersSquareOptions.color);if(t.fill("evenodd"),(H=o.cornersDotOptions)===null||H===void 0?void 0:H.type){const N=new St({context:t,type:(L=o.cornersDotOptions)===null||L===void 0?void 0:L.type});t.beginPath(),N.draw(nt+2*a,$+2*a,s,w)}else{const N=new tt({context:t,type:o.dotsOptions.type});t.beginPath();for(let I=0;I<wt.length;I++)for(let B=0;B<wt[I].length;B++)!((V=wt[I])===null||V===void 0)&&V[B]&&N.draw(nt+I*a,$+B*a,a,(K,et)=>{var P;return!!(!((P=wt[I+K])===null||P===void 0)&&P[B+et])})}if(!((D=o.cornersDotOptions)===null||D===void 0)&&D.gradient){const N=o.cornersDotOptions.gradient,I=this._createGradient({context:t,options:N,additionalRotation:w,x:nt+2*a,y:$+2*a,size:s});N.colorStops.forEach(({offset:B,color:K})=>{I.addColorStop(B,K)}),t.fillStyle=t.strokeStyle=I}else!((at=o.cornersDotOptions)===null||at===void 0)&&at.color&&(t.fillStyle=t.strokeStyle=o.cornersDotOptions.color);t.fill("evenodd")})}loadImage(){return new Promise((e,t)=>{const o=this._options,n=new Image;if(!o.image)return t("Image is not defined");typeof o.imageOptions.crossOrigin=="string"&&(n.crossOrigin=o.imageOptions.crossOrigin),this._image=n,n.onload=()=>{e()},n.src=o.image})}drawImage({width:e,height:t,count:o,dotSize:n}){const r=this.context;if(!r)throw"canvasContext is not defined";if(!this._image)throw"image is not defined";const a=this._options,i=Math.floor((a.width-o*n)/2),s=Math.floor((a.height-o*n)/2),c=i+a.imageOptions.margin+(o*n-e)/2,l=s+a.imageOptions.margin+(o*n-t)/2,d=e-2*a.imageOptions.margin,g=t-2*a.imageOptions.margin;r.drawImage(this._image,c,l,d<0?0:d,g<0?0:g)}_createGradient({context:e,options:t,additionalRotation:o,x:n,y:r,size:a}){let i;if(t.type===R)i=e.createRadialGradient(n+a/2,r+a/2,0,n+a/2,r+a/2,a/2);else{const s=((t.rotation||0)+o)%(2*Math.PI),c=(s+2*Math.PI)%(2*Math.PI);let l=n+a/2,d=r+a/2,g=n+a/2,w=r+a/2;c>=0&&c<=.25*Math.PI||c>1.75*Math.PI&&c<=2*Math.PI?(l-=a/2,d-=a/2*Math.tan(s),g+=a/2,w+=a/2*Math.tan(s)):c>.25*Math.PI&&c<=.75*Math.PI?(d-=a/2,l-=a/2/Math.tan(s),w+=a/2,g+=a/2/Math.tan(s)):c>.75*Math.PI&&c<=1.25*Math.PI?(l+=a/2,d+=a/2*Math.tan(s),g-=a/2,w-=a/2*Math.tan(s)):c>1.25*Math.PI&&c<=1.75*Math.PI&&(d+=a/2,l+=a/2/Math.tan(s),w-=a/2,g-=a/2/Math.tan(s)),i=e.createLinearGradient(Math.round(l),Math.round(d),Math.round(g),Math.round(w))}return i}}class Mt{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,o,n){let r;switch(this._type){case Q:r=this._drawDot;break;case rt:r=this._drawClassy;break;case it:r=this._drawClassyRounded;break;case pt:r=this._drawRounded;break;case j:r=this._drawExtraRounded;break;default:r=this._drawSquare}r.call(this,{x:e,y:t,size:o,getNeighbor:n})}_rotateFigure({x:e,y:t,size:o,rotation:n=0,draw:r}){var a;const i=e+o/2,s=t+o/2;r(),(a=this._element)===null||a===void 0||a.setAttribute("transform",`rotate(${180*n/Math.PI},${i},${s})`)}_basicDot(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(o+t/2)),this._element.setAttribute("cy",String(n+t/2)),this._element.setAttribute("r",String(t/2))}}))}_basicSquare(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(o)),this._element.setAttribute("y",String(n)),this._element.setAttribute("width",String(t)),this._element.setAttribute("height",String(t))}}))}_basicSideRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h `+t/2+`a ${t/2} ${t/2}, 0, 0, 0, 0 ${-t}`)}}))}_basicCornerRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h ${t}v `+-t/2+`a ${t/2} ${t/2}, 0, 0, 0, ${-t/2} ${-t/2}`)}}))}_basicCornerExtraRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h ${t}a ${t} ${t}, 0, 0, 0, ${-t} ${-t}`)}}))}_basicCornersRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v `+t/2+`a ${t/2} ${t/2}, 0, 0, 0, ${t/2} ${t/2}h `+t/2+"v "+-t/2+`a ${t/2} ${t/2}, 0, 0, 0, ${-t/2} ${-t/2}`)}}))}_drawDot({x:e,y:t,size:o}){this._basicDot({x:e,y:t,size:o,rotation:0})}_drawSquare({x:e,y:t,size:o}){this._basicSquare({x:e,y:t,size:o,rotation:0})}_drawRounded({x:e,y:t,size:o,getNeighbor:n}){const r=n?+n(-1,0):0,a=n?+n(1,0):0,i=n?+n(0,-1):0,s=n?+n(0,1):0,c=r+a+i+s;if(c!==0)if(c>2||r&&a||i&&s)this._basicSquare({x:e,y:t,size:o,rotation:0});else{if(c===2){let l=0;return r&&i?l=Math.PI/2:i&&a?l=Math.PI:a&&s&&(l=-Math.PI/2),void this._basicCornerRounded({x:e,y:t,size:o,rotation:l})}if(c===1){let l=0;return i?l=Math.PI/2:a?l=Math.PI:s&&(l=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,rotation:l})}}else this._basicDot({x:e,y:t,size:o,rotation:0})}_drawExtraRounded({x:e,y:t,size:o,getNeighbor:n}){const r=n?+n(-1,0):0,a=n?+n(1,0):0,i=n?+n(0,-1):0,s=n?+n(0,1):0,c=r+a+i+s;if(c!==0)if(c>2||r&&a||i&&s)this._basicSquare({x:e,y:t,size:o,rotation:0});else{if(c===2){let l=0;return r&&i?l=Math.PI/2:i&&a?l=Math.PI:a&&s&&(l=-Math.PI/2),void this._basicCornerExtraRounded({x:e,y:t,size:o,rotation:l})}if(c===1){let l=0;return i?l=Math.PI/2:a?l=Math.PI:s&&(l=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,rotation:l})}}else this._basicDot({x:e,y:t,size:o,rotation:0})}_drawClassy({x:e,y:t,size:o,getNeighbor:n}){const r=n?+n(-1,0):0,a=n?+n(1,0):0,i=n?+n(0,-1):0,s=n?+n(0,1):0;r+a+i+s!==0?r||i?a||s?this._basicSquare({x:e,y:t,size:o,rotation:0}):this._basicCornerRounded({x:e,y:t,size:o,rotation:Math.PI/2}):this._basicCornerRounded({x:e,y:t,size:o,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,rotation:Math.PI/2})}_drawClassyRounded({x:e,y:t,size:o,getNeighbor:n}){const r=n?+n(-1,0):0,a=n?+n(1,0):0,i=n?+n(0,-1):0,s=n?+n(0,1):0;r+a+i+s!==0?r||i?a||s?this._basicSquare({x:e,y:t,size:o,rotation:0}):this._basicCornerExtraRounded({x:e,y:t,size:o,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:e,y:t,size:o,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,rotation:Math.PI/2})}}class zt{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,o,n){let r;switch(this._type){case dt:r=this._drawSquare;break;case ct:r=this._drawExtraRounded;break;default:r=this._drawDot}r.call(this,{x:e,y:t,size:o,rotation:n})}_rotateFigure({x:e,y:t,size:o,rotation:n=0,draw:r}){var a;const i=e+o/2,s=t+o/2;r(),(a=this._element)===null||a===void 0||a.setAttribute("transform",`rotate(${180*n/Math.PI},${i},${s})`)}_basicDot(e){const{size:t,x:o,y:n}=e,r=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${o+t/2} ${n}a ${t/2} ${t/2} 0 1 0 0.1 0zm 0 ${r}a ${t/2-r} ${t/2-r} 0 1 1 -0.1 0Z`)}}))}_basicSquare(e){const{size:t,x:o,y:n}=e,r=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h ${t}v `+-t+`zM ${o+r} ${n+r}h `+(t-2*r)+"v "+(t-2*r)+"h "+(2*r-t)+"z")}}))}_basicExtraRounded(e){const{size:t,x:o,y:n}=e,r=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${o} ${n+2.5*r}v `+2*r+`a ${2.5*r} ${2.5*r}, 0, 0, 0, ${2.5*r} ${2.5*r}h `+2*r+`a ${2.5*r} ${2.5*r}, 0, 0, 0, ${2.5*r} ${2.5*-r}v `+-2*r+`a ${2.5*r} ${2.5*r}, 0, 0, 0, ${2.5*-r} ${2.5*-r}h `+-2*r+`a ${2.5*r} ${2.5*r}, 0, 0, 0, ${2.5*-r} ${2.5*r}M ${o+2.5*r} ${n+r}h `+2*r+`a ${1.5*r} ${1.5*r}, 0, 0, 1, ${1.5*r} ${1.5*r}v `+2*r+`a ${1.5*r} ${1.5*r}, 0, 0, 1, ${1.5*-r} ${1.5*r}h `+-2*r+`a ${1.5*r} ${1.5*r}, 0, 0, 1, ${1.5*-r} ${1.5*-r}v `+-2*r+`a ${1.5*r} ${1.5*r}, 0, 0, 1, ${1.5*r} ${1.5*-r}`)}}))}_drawDot({x:e,y:t,size:o,rotation:n}){this._basicDot({x:e,y:t,size:o,rotation:n})}_drawSquare({x:e,y:t,size:o,rotation:n}){this._basicSquare({x:e,y:t,size:o,rotation:n})}_drawExtraRounded({x:e,y:t,size:o,rotation:n}){this._basicExtraRounded({x:e,y:t,size:o,rotation:n})}}class Rt{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,o,n){let r;r=this._type===mt?this._drawSquare:this._drawDot,r.call(this,{x:e,y:t,size:o,rotation:n})}_rotateFigure({x:e,y:t,size:o,rotation:n=0,draw:r}){var a;const i=e+o/2,s=t+o/2;r(),(a=this._element)===null||a===void 0||a.setAttribute("transform",`rotate(${180*n/Math.PI},${i},${s})`)}_basicDot(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(o+t/2)),this._element.setAttribute("cy",String(n+t/2)),this._element.setAttribute("r",String(t/2))}}))}_basicSquare(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(o)),this._element.setAttribute("y",String(n)),this._element.setAttribute("width",String(t)),this._element.setAttribute("height",String(t))}}))}_drawDot({x:e,y:t,size:o,rotation:n}){this._basicDot({x:e,y:t,size:o,rotation:n})}_drawSquare({x:e,y:t,size:o,rotation:n}){this._basicSquare({x:e,y:t,size:o,rotation:n})}}const vt=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],p=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class f{constructor(e){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(e.width)),this._element.setAttribute("height",String(e.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._style=document.createElementNS("http://www.w3.org/2000/svg","style"),this._options=e}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}clear(){var e;const t=this._element;this._element=t.cloneNode(!1),(e=t==null?void 0:t.parentNode)===null||e===void 0||e.replaceChild(this._element,t),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._style=document.createElementNS("http://www.w3.org/2000/svg","style"),this._element.appendChild(this._style),this._element.appendChild(this._defs)}async drawQR(e){const t=e.getModuleCount(),o=Math.min(this._options.width,this._options.height)-2*this._options.margin,n=Math.floor(o/t);let r={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=e,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:a,qrOptions:i}=this._options,s=a.imageSize*q[i.errorCorrectionLevel],c=Math.floor(s*t*t);r=T({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:c,maxHiddenAxisDots:t-14,dotSize:n})}this._element.appendChild(this._style),this._element.appendChild(this._defs),this.clear(),this.drawBackground(),this.drawDots((a,i)=>{var s,c,l,d,g,w;return!(this._options.imageOptions.hideBackgroundDots&&a>=(t-r.hideXDots)/2&&a<(t+r.hideXDots)/2&&i>=(t-r.hideYDots)/2&&i<(t+r.hideYDots)/2||!((s=vt[a])===null||s===void 0)&&s[i]||!((c=vt[a-t+7])===null||c===void 0)&&c[i]||!((l=vt[a])===null||l===void 0)&&l[i-t+7]||!((d=p[a])===null||d===void 0)&&d[i]||!((g=p[a-t+7])===null||g===void 0)&&g[i]||!((w=p[a])===null||w===void 0)&&w[i-t+7])}),this.drawCorners(),this._options.image&&await this.drawImage({width:r.width,height:r.height,count:t,dotSize:n})}drawBackground(){var e,t,o;const n=this._element,r=this._options;if(n){const a=(e=r.backgroundOptions)===null||e===void 0?void 0:e.gradient,i=(t=r.backgroundOptions)===null||t===void 0?void 0:t.color;a?this._createColor({options:a,color:i,additionalRotation:0,x:0,y:0,height:r.height,width:r.width,name:"background-color"}):!((o=r.backgroundOptions)===null||o===void 0)&&o.color&&this._createStyle({color:i,name:"background-color"})}}drawDots(e){var t,o,n;if(!this._qr)throw"QR code is not defined";const r=this._options,a=this._qr.getModuleCount();if(a>r.width||a>r.height)throw"The canvas is too small.";const i=Math.min(r.width,r.height)-2*r.margin,s=Math.floor(i/a),c=Math.floor((r.width-a*s)/2),l=Math.floor((r.height-a*s)/2),d=new Mt({svg:this._element,type:r.dotsOptions.type});!((t=r.dotsOptions)===null||t===void 0)&&t.gradient?(this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(o=r.dotsOptions)===null||o===void 0?void 0:o.gradient,color:r.dotsOptions.color,additionalRotation:0,x:c,y:l,height:a*s,width:a*s,name:"dot-color"})):r.dotsOptions.color&&(this._dots=document.createElementNS("http://www.w3.org/2000/svg","g"),this._dots.setAttribute("class","dot-color"),this._element.appendChild(this._dots),this._createStyle({color:r.dotsOptions.color,name:"dot-color"}));for(let g=0;g<a;g++)for(let w=0;w<a;w++){if(e&&!e(g,w)||!(!((n=this._qr)===null||n===void 0)&&n.isDark(g,w)))continue;const x=this._options.useLegacyDotRotation?c+g*s:l+w*s,C=this._options.useLegacyDotRotation?l+w*s:c+g*s;d.draw(x,C,s,(O,z)=>this._options.useLegacyDotRotation?!(g+O<0||w+z<0||g+O>=a||w+z>=a)&&!(e&&!e(g+O,w+z))&&!!this._qr&&this._qr.isDark(g+O,w+z):!(w+O<0||g+z<0||w+O>=a||g+z>=a)&&!(e&&!e(w+O,g+z))&&!!this._qr&&this._qr.isDark(g+z,w+O)),d._element&&this._dotsClipPath?this._dotsClipPath.appendChild(d._element):d._element&&this._dots&&this._dots.appendChild(d._element)}}drawCorners(){if(!this._qr)throw"QR code is not defined";const e=this._element,t=this._options;if(!e)throw"Element code is not defined";const o=this._qr.getModuleCount(),n=Math.min(t.width,t.height)-2*t.margin,r=Math.floor(n/o),a=7*r,i=3*r,s=Math.floor((t.width-o*r)/2),c=Math.floor((t.height-o*r)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([l,d,g])=>{var w,x,C,O,z,W,H,L,V,D,at,nt,$,N;const I=s+l*r*(o-7),B=c+d*r*(o-7);let K=this._dotsClipPath,et=this._dotsClipPath;if(!((w=t.cornersSquareOptions)===null||w===void 0)&&w.gradient?(K=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),K.setAttribute("id",`clip-path-corners-square-color-${l}-${d}`),this._defs.appendChild(K),this._cornersSquareClipPath=this._cornersDotClipPath=et=K,this._createColor({options:(x=t.cornersSquareOptions)===null||x===void 0?void 0:x.gradient,color:(C=t.cornersSquareOptions)===null||C===void 0?void 0:C.color,additionalRotation:g,x:I,y:B,height:a,width:a,name:`corners-square-color-${l}-${d}`})):(this._cornerSquares=document.createElementNS("http://www.w3.org/2000/svg","g"),this._cornerSquares.setAttribute("class",`corners-square-color-${l}-${d}`),this._element.appendChild(this._cornerSquares),this._createStyle({color:(O=t.cornersSquareOptions)===null||O===void 0?void 0:O.color,name:`corners-square-color-${l}-${d}`})),(z=t.cornersSquareOptions)===null||z===void 0?void 0:z.type){const P=new zt({svg:this._element,type:t.cornersSquareOptions.type});P.draw(I,B,a,g),!((W=t.cornersSquareOptions)===null||W===void 0)&&W.gradient&&P._element&&K?K.appendChild(P._element):P._element&&this._cornerSquares&&this._cornerSquares.appendChild(P._element)}else{const P=new Mt({svg:this._element,type:t.dotsOptions.type});for(let ut=0;ut<vt.length;ut++)for(let ft=0;ft<vt[ut].length;ft++)!((H=vt[ut])===null||H===void 0)&&H[ft]&&(P.draw(I+ut*r,B+ft*r,r,(Bt,Et)=>{var bt;return!!(!((bt=vt[ut+Bt])===null||bt===void 0)&&bt[ft+Et])}),P._element&&this._cornersSquareClipPath?this._cornersSquareClipPath.appendChild(P._element):P._element&&this._cornerSquares&&this._cornerSquares.appendChild(P._element))}if(!((L=t.cornersDotOptions)===null||L===void 0)&&L.gradient?(et=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),et.setAttribute("id",`clip-path-corners-dot-color-${l}-${d}`),this._defs.appendChild(et),this._cornersDotClipPath=et,this._createColor({options:(V=t.cornersDotOptions)===null||V===void 0?void 0:V.gradient,color:(D=t.cornersDotOptions)===null||D===void 0?void 0:D.color,additionalRotation:g,x:I+2*r,y:B+2*r,height:i,width:i,name:`corners-dot-color-${l}-${d}`})):(this._cornerDots=document.createElementNS("http://www.w3.org/2000/svg","g"),this._cornerDots.setAttribute("class",`corners-dot-color-${l}-${d}`),this._element.appendChild(this._cornerDots),this._createStyle({color:(at=t.cornersDotOptions)===null||at===void 0?void 0:at.color,name:`corners-dot-color-${l}-${d}`})),(nt=t.cornersDotOptions)===null||nt===void 0?void 0:nt.type){const P=new Rt({svg:this._element,type:t.cornersDotOptions.type});P.draw(I+2*r,B+2*r,i,g),!(($=t.cornersDotOptions)===null||$===void 0)&&$.gradient&&P._element&&et?et.appendChild(P._element):P._element&&this._cornerDots&&this._cornerDots.appendChild(P._element)}else{const P=new Mt({svg:this._element,type:t.dotsOptions.type});for(let ut=0;ut<p.length;ut++)for(let ft=0;ft<p[ut].length;ft++)!((N=p[ut])===null||N===void 0)&&N[ft]&&(P.draw(I+ut*r,B+ft*r,r,(Bt,Et)=>{var bt;return!!(!((bt=p[ut+Bt])===null||bt===void 0)&&bt[ft+Et])}),P._element&&this._cornersDotClipPath?this._cornersDotClipPath.appendChild(P._element):P._element&&this._cornerDots&&this._cornerDots.appendChild(P._element))}})}loadImage(){return new Promise((e,t)=>{const o=this._options,n=new Image;if(!o.image)return t("Image is not defined");typeof o.imageOptions.crossOrigin=="string"&&(n.crossOrigin=o.imageOptions.crossOrigin),this._image=n,n.onload=()=>{e()},n.src=o.image})}async drawImage({width:e,height:t,count:o,dotSize:n}){const r=this._options,a=Math.floor((r.width-o*n)/2),i=Math.floor((r.height-o*n)/2),s=a+r.imageOptions.margin+(o*n-e)/2,c=i+r.imageOptions.margin+(o*n-t)/2,l=e-2*r.imageOptions.margin,d=t-2*r.imageOptions.margin,g=document.createElementNS("http://www.w3.org/2000/svg","image"),w=await this._getBase64Image(r.image||"");g.setAttribute("href",w),g.setAttribute("xlink:href",w),g.setAttribute("x",String(s)),g.setAttribute("y",String(c)),g.setAttribute("width",`${l}px`),g.setAttribute("height",`${d}px`),this._element.appendChild(g)}async _getImageBlob(e){return(await fetch(e)).blob()}_blobToBase64(e){return new Promise(t=>{const o=new FileReader;o.onload=function(){const n=o.result;t(n)},o.readAsDataURL(e)})}async _getBase64Image(e){if(e==="")return new Promise(o=>{o("")});const t=await this._getImageBlob(e);return await this._blobToBase64(t)}_createColor({options:e,color:t,additionalRotation:o,x:n,y:r,height:a,width:i,name:s}){const c=i>a?i:a,l=document.createElementNS("http://www.w3.org/2000/svg","rect");if(l.setAttribute("x",String(n)),l.setAttribute("y",String(r)),l.setAttribute("height",String(a)),l.setAttribute("width",String(i)),l.setAttribute("clip-path",`url('#clip-path-${s}')`),e){let d;if(e.type===R)d=document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),d.setAttribute("id",s),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("fx",String(n+i/2)),d.setAttribute("fy",String(r+a/2)),d.setAttribute("cx",String(n+i/2)),d.setAttribute("cy",String(r+a/2)),d.setAttribute("r",String(c/2));else{const g=((e.rotation||0)+o)%(2*Math.PI),w=(g+2*Math.PI)%(2*Math.PI);let x=n+i/2,C=r+a/2,O=n+i/2,z=r+a/2;w>=0&&w<=.25*Math.PI||w>1.75*Math.PI&&w<=2*Math.PI?(x-=i/2,C-=a/2*Math.tan(g),O+=i/2,z+=a/2*Math.tan(g)):w>.25*Math.PI&&w<=.75*Math.PI?(C-=a/2,x-=i/2/Math.tan(g),z+=a/2,O+=i/2/Math.tan(g)):w>.75*Math.PI&&w<=1.25*Math.PI?(x+=i/2,C+=a/2*Math.tan(g),O-=i/2,z-=a/2*Math.tan(g)):w>1.25*Math.PI&&w<=1.75*Math.PI&&(C+=a/2,x+=i/2/Math.tan(g),z-=a/2,O-=i/2/Math.tan(g)),d=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),d.setAttribute("id",s),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("x1",String(Math.round(x))),d.setAttribute("y1",String(Math.round(C))),d.setAttribute("x2",String(Math.round(O))),d.setAttribute("y2",String(Math.round(z)))}e.colorStops.forEach(({offset:g,color:w})=>{const x=document.createElementNS("http://www.w3.org/2000/svg","stop");x.setAttribute("offset",100*g+"%"),x.setAttribute("stop-color",w),d.appendChild(x)}),l.setAttribute("fill",`url('#${s}')`),this._defs.appendChild(d)}else t&&l.setAttribute("fill",t);this._element.appendChild(l)}_createStyle({color:e,name:t}){this._style.innerHTML+=`.${t}{ fill: ${e}; }`}}const _="canvas",h={};for(let M=0;M<=40;M++)h[M]=M;const u={type:_,width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:h[0],mode:void 0,errorCorrectionLevel:"Q",multibyte:"default"},imageOptions:{hideBackgroundDots:!0,imageSize:.4,crossOrigin:"anonymous",margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{color:"#fff"},useLegacyDotRotation:!1};function m(M){const e=Object.assign({},M);if(!e.colorStops||!e.colorStops.length)throw"Field 'colorStops' is required in gradient";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map(t=>Object.assign(Object.assign({},t),{offset:Number(t.offset)})),e}function b(M){const e=Object.assign({},M);return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions=Object.assign(Object.assign({},e.imageOptions),{hideBackgroundDots:Boolean(e.imageOptions.hideBackgroundDots),imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)}),e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions=Object.assign({},e.dotsOptions),e.dotsOptions.gradient&&(e.dotsOptions.gradient=m(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions=Object.assign({},e.cornersSquareOptions),e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=m(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions=Object.assign({},e.cornersDotOptions),e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=m(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions=Object.assign({},e.backgroundOptions),e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=m(e.backgroundOptions.gradient))),e}var v=k(192),S=k.n(v);class X{constructor(e){this._options=e?b(U(u,e)):u,this.update()}static _clearContainer(e){e&&(e.innerHTML="")}async _getQRStylingElement(e){if(!this._qr)throw"QR code is empty";if(e.toLowerCase()==="svg"){let t,o;return this._svg&&this._svgDrawingPromise?(o=this._svg,t=this._svgDrawingPromise):(o=new f(this._options),t=o.drawQR(this._qr)),await t,o}{let t,o;return this._canvas&&this._canvasDrawingPromise?(o=this._canvas,t=this._canvasDrawingPromise):(o=new Ot(this._options),t=o.drawQR(this._qr)),await t,o}}update(e){X._clearContainer(this._container),this._options=e?b(U(this._options,e)):this._options,this._options.data&&(S().stringToBytes=S().stringToBytesFuncs[this._options.qrOptions.multibyte],this._qr=S()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(t){switch(!0){case/^[0-9]*$/.test(t):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(t):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===_?(this._canvas=new Ot(this._options),this._canvasDrawingPromise=this._canvas.drawQR(this._qr),this._svgDrawingPromise=void 0,this._svg=void 0):(this._svg=new f(this._options),this._svgDrawingPromise=this._svg.drawQR(this._qr),this._canvasDrawingPromise=void 0,this._canvas=void 0),this.append(this._container))}append(e){if(e){if(typeof e.appendChild!="function")throw"Container should be a single DOM node";this._options.type===_?this._canvas&&e.appendChild(this._canvas.getCanvas()):this._svg&&e.appendChild(this._svg.getElement()),this._container=e}}async getRawData(e="png",t){if(!this._qr)throw"QR code is empty";const o=e.toLocaleLowerCase();if(o==="svg"){const n=await this._getQRStylingElement(o),r=new XMLSerializer().serializeToString(n.getElement());return new Blob([`<?xml version="1.0" standalone="no"?>\r
`+r],{type:"image/svg+xml"})}{const n=await this._getQRStylingElement(o);return new Promise(r=>n.getCanvas().toBlob(r,`image/${o}`,t))}}async toDataUrl(e="png",t){if(!this._qr)throw"QR code is empty";const o=e.toLocaleLowerCase();return(await this._getQRStylingElement(o)).getCanvas().toDataURL(`image/${o}`,t)}async download(e){if(!this._qr)throw"QR code is empty";let t="png",o="qr";typeof e=="object"&&e!==null&&(e.name&&(o=e.name),e.extension&&(t=e.extension));const n=t.toLocaleLowerCase();if(n==="svg"){const r=await this._getQRStylingElement(n);let a=new XMLSerializer().serializeToString(r.getElement());a=`<?xml version="1.0" standalone="no"?>\r
`+a,J("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a),`${o}.svg`)}else J((await this._getQRStylingElement(n)).getCanvas().toDataURL(`image/${t}`),`${o}.${t}`)}}const Y=X})(),Z.default})())})(ne);const re=ee(Vt),ie={key:0,class:"ctool-page-option",style:{"margin-top":"5px"}},ge=Nt({__name:"Generate",async setup(F){let lt,_t;const y=Ut(([lt,_t]=Zt(()=>Qt({input:Ht(),option:Ft(),output:Gt("image")})),lt=await lt,_t(),lt)),k="default";let Z=Lt(yt.empty()),E=Lt(yt.empty());const U=async()=>{if(y.current.input.text.isError()){E.value=yt.fromError(y.current.input.text.toString());return}if(E.value=yt.empty(),!y.current.input.text.isEmpty())try{const q=await new re(oe(y.current.option,y.current.input.text.toString(),Z.value)).getRawData();if(!q)throw new Error("generated error");E.value=await yt.fromBlob(q)}catch(T){E.value=yt.fromError($error(T))}},J=async T=>{Z.value=(await yt.fromBlob(T)).setFileName(T.name)};return Jt(()=>({option:y.current.option,image:Z.value,text:y.current.input.text}),()=>U(),{immediate:!0,deep:!0}),(T,q)=>{const Q=st("TextInput"),pt=st("Bool"),rt=st("Display"),it=st("TextOutput"),j=st("HeightResize"),tt=st("InputNumber"),dt=st("Select"),ct=st("UploadFile"),gt=st("Align"),mt=st("Tabs"),St=te("row");return xt(),jt(Tt,null,[Kt((xt(),At(j,{append:[".ctool-page-option"]},{default:ht(({height:R})=>[G(rt,{position:"bottom-right"},{extra:ht(()=>[E.value.isEmpty()||E.value.isError()?kt("",!0):(xt(),At(pt,{key:0,size:"small",modelValue:A(y).current.option.is_show,"onUpdate:modelValue":q[1]||(q[1]=ot=>A(y).current.option.is_show=ot),label:T.$t("main_ui_setting"),border:""},null,8,["modelValue","label"]))]),default:ht(()=>[G(Q,{modelValue:A(y).current.input,"onUpdate:modelValue":q[0]||(q[0]=ot=>A(y).current.input=ot),height:R,upload:"file"},null,8,["modelValue","height"])]),_:2},1024),G(it,{modelValue:A(y).current.output,"onUpdate:modelValue":q[2]||(q[2]=ot=>A(y).current.output=ot),allow:["image","hex","base64"],content:E.value,height:R,onSuccess:q[3]||(q[3]=ot=>A(y).save())},null,8,["modelValue","content","height"])]),_:1},8,["append"])),[[St,"1-320px"]]),A(y).current.option.is_show?(xt(),jt("div",ie,[G(mt,{modelValue:A(y).current.option.tab,"onUpdate:modelValue":q[15]||(q[15]=R=>A(y).current.option.tab=R),lists:[{label:T.$t("qrCode_generate_option_common"),name:"common"},{label:T.$t("qrCode_generate_option_content"),name:"content"},{label:T.$t("qrCode_generate_option_corners_square"),name:"corners_square"},{label:T.$t("qrCode_generate_option_corners_dot"),name:"corners_dot"},{label:T.$t("qrCode_generate_option_background"),name:"background"}]},{default:ht(()=>[G(gt,null,{default:ht(()=>[G(tt,{size:k,width:120,modelValue:A(y).current.option.margin,"onUpdate:modelValue":q[4]||(q[4]=R=>A(y).current.option.margin=R),max:1e3},{prepend:ht(()=>[Pt($t(T.$t("qrCode_generate_option_margin")),1)]),_:1},8,["modelValue"]),G(dt,{size:k,options:["L","M","Q","H"],modelValue:A(y).current.option.error_correction_level,"onUpdate:modelValue":q[5]||(q[5]=R=>A(y).current.option.error_correction_level=R),label:T.$t("qrCode_generate_option_correction")},null,8,["modelValue","label"]),G(ct,{size:k,onSuccess:J,"button-type":"text",type:"image"}),G(tt,{size:k,width:100,modelValue:A(y).current.option.image_options.size,"onUpdate:modelValue":q[6]||(q[6]=R=>A(y).current.option.image_options.size=R),max:10},{prepend:ht(()=>[Pt($t(T.$t("qrCode_generate_option_size")),1)]),_:1},8,["modelValue"]),G(tt,{size:k,width:120,modelValue:A(y).current.option.image_options.margin,"onUpdate:modelValue":q[7]||(q[7]=R=>A(y).current.option.image_options.margin=R),max:1e3},{prepend:ht(()=>[Pt($t(T.$t("qrCode_generate_option_margin")),1)]),_:1},8,["modelValue"])]),_:1}),G(qt,{modelValue:A(y).current.option.dots_options.color,"onUpdate:modelValue":q[9]||(q[9]=R=>A(y).current.option.dots_options.color=R),size:k},{default:ht(()=>[G(dt,{modelValue:A(y).current.option.dots_options.type,"onUpdate:modelValue":q[8]||(q[8]=R=>A(y).current.option.dots_options.type=R),options:A(It)(["square","dots","rounded","classy","extra-rounded","classy-rounded"],"qrCode_generate_option_"),size:k,label:T.$t("qrCode_generate_option_style")},null,8,["modelValue","options","label"])]),_:1},8,["modelValue"]),G(qt,{modelValue:A(y).current.option.corners_square_options.color,"onUpdate:modelValue":q[11]||(q[11]=R=>A(y).current.option.corners_square_options.color=R),size:k},{default:ht(()=>[G(dt,{modelValue:A(y).current.option.corners_square_options.type,"onUpdate:modelValue":q[10]||(q[10]=R=>A(y).current.option.corners_square_options.type=R),options:A(It)(["dot","square","extra-rounded"],"qrCode_generate_option_"),size:k,label:T.$t("qrCode_generate_option_style")},null,8,["modelValue","options","label"])]),_:1},8,["modelValue"]),G(qt,{modelValue:A(y).current.option.corners_dot_options.color,"onUpdate:modelValue":q[13]||(q[13]=R=>A(y).current.option.corners_dot_options.color=R),size:k},{default:ht(()=>[G(dt,{modelValue:A(y).current.option.corners_dot_options.type,"onUpdate:modelValue":q[12]||(q[12]=R=>A(y).current.option.corners_dot_options.type=R),options:A(It)(["dot","square"],"qrCode_generate_option_"),size:k,label:T.$t("qrCode_generate_option_style")},null,8,["modelValue","options","label"])]),_:1},8,["modelValue"]),G(qt,{modelValue:A(y).current.option.background_options.color,"onUpdate:modelValue":q[14]||(q[14]=R=>A(y).current.option.background_options.color=R),size:k},null,8,["modelValue"])]),_:1},8,["modelValue","lists"])])):kt("",!0)],64)}}});export{ge as default};
